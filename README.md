# Проект для итоговой аттестации SkillFactory
## Задача
Разработать REST API submitData для сервиса ФСТР, включающий в себя
- метод для добавление данных о перевале
- метод для получения списка всех записей
- метод для получения одной записи по ее id
- метод для редактирования существующей записи
___
## Требование к REST API

### Метод POST submitData
Когда турист поднимется на перевал, он сфотографирует его и внесёт нужную информацию с помощью мобильного приложения:

- координаты объекта и его высоту;
- название объекта;
- несколько фотографий;
- информацию о пользователе, который передал данные о перевале:
  - имя пользователя (ФИО строкой);
  - почта;
  - телефон

После этого турист нажмёт кнопку «Отправить» в мобильном приложении. Мобильное приложение вызовет метод **submitData** REST API.

Метод submitData принимает JSON в теле запроса с информацией о перевале. Пример входного JSON-а:
```commandline
{
  "beauty_title": "пер. ",
  "title": "Пхия",
  "other_titles": "Триев",
  "connect": "", 
  "add_time": "2021-09-22 13:18:13",
  "user": {
    "email": "qwerty@mail.ru", 		
    "fam": "Пупкин",
    "name": "Василий",
    "otc": "Иванович",
    "phone": "+75555555"
    }, 
  "coords": {
    "latitude": "45.3842",
    "longitude": "7.1525",
    "height": "1200"
    }
  level:{
    "winter": "", 
    "summer": "1А",
    "autumn": "1А",
    "spring": ""
    },
   images: [
    {
        data:"<картинка1>", 
        title:"Седловина"
    }, 
    {
        data:"<картинка>", 
        title:"Подъём"
    }
   ]
}
```
Результат метода: JSON

- **status** — код HTTP, целое число:
   - 500 — ошибка при выполнении операции;
   - 400 — Bad Request (при нехватке полей);
   - 200 — успех.
 - **message** — строка:
   - Причина ошибки (если она была);
   - Отправлено успешно;
   - Если отправка успешна, дополнительно возвращается id вставленной записи.
 - **id** — идентификатор, который был присвоен объекту при добавлении в базу данных.

**Примеры:**
 - { "status": 500, "message": "Ошибка подключения к базе данных","id": null}
 - { "status": 200, "message": null, "id": 42 }
___
### Метод GET submitData
Выводит список всех объектов.
Позволяет получить список данных обо всех объектах, которые пользователь с почтой email отправил на сервер. Email пользователя при этом передается в query-параметре:
```commandline
GET /submitData/?user__email=<email>
```
Также позволяет получить информацию по одному объекту по его id:
```commandline
GET /submitData/<id>
```
___
### Метод PATCH submitData
Редактировать существующую запись (замена), если она в статусе new.
Редактировать можно все поля, кроме тех, что содержат в себе ФИО, адрес почты и номер телефона. Метод принимает тот же самый json, что и метод POST submitData.

В ответе возвращается:
- **state**:
    - **1** — если успешно удалось отредактировать запись в базе данных.
    - **0** — в противном случае.
- **message** — содержит причину, по которой обновление невозможно.
___
Спецификация: https://ddvalk.pythonanywhere.com/api/v1/
Swagger: https://ddvalk.pythonanywhere.com/swagger/